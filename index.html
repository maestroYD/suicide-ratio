<!doctype html>
<html>
<head>
  <script src="https://cdn.anychart.com/releases/8.2.1/js/anychart-base.min.js"></script>
  <script src="https://cdn.anychart.com/releases/8.2.1/js/anychart-ui.min.js"></script>
  <script src="https://cdn.anychart.com/releases/8.2.1/js/anychart-exports.min.js"></script>
  <script src="https://cdn.anychart.com/releases/8.2.1/js/anychart-map.min.js"></script>
  <script src="https://cdn.anychart.com/releases/8.2.1/js/anychart-data-adapter.min.js"></script>
  <script src="https://cdn.anychart.com/geodata/1.2.0/custom/world/world.js"></script>
<!--   <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.15/proj4.js"></script> -->
  <link rel="stylesheet" href="https://cdn.anychart.com/releases/8.2.1/css/anychart-ui.min.css" />
  <link rel="stylesheet" href="https://cdn.anychart.com/releases/8.2.1/fonts/css/anychart-font.min.css" />
  <style>
/*    html, body, #container {
      width: 100%;
      height: 85%;
      margin: 0;
      padding: 0;
    },
    html, body, #container {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }*/
  </style>
</head>
<body>
    <div id="container"></div>
    <div id="chart"></div>
    <!-- <div id="chart"></div> -->
    <script type="text/javascript">
anychart.onDocumentReady(function() { 
  anychart.data.loadJsonFile('./data.json', function(data){
    var stage = anychart.graphics.create("container", 1200, 800);

    var map = anychart.map();

    // get suicide rate
    var func_listen = function(e){
        console.log(e.pointIndex)
        fetch('http://localhost:5000/countries/suicide/Japan', {
          method: 'GET',
        }).then(response => response.json())
          .then(data => {
            console.log(data)
          })
    };

    function getData(){
      var temp = []
      fetch('http://localhost:5000/countries/worldwide', {
        method: 'GET',
      }).then(response => response.json())
          .then(data => {
            for (var i = 0; i < data.length; i++) {
              temp.push(data[i])
            }
            console.log(temp)
          })
      return temp    
    }

    // add a listener
    map.listen('dblclick', func_listen);

    map.credits()
      .enabled(false)
      .url('https://en.wikipedia.org/wiki/List_of_sovereign_states_and_dependent_territories_by_population_density')
      .logoSrc('https://en.wikipedia.org/static/favicon/wikipedia.ico')
      .text('Data source: https://en.wikipedia.org/wiki/List_of_sovereign_states_and_dependent_territories_by_population_density');

    map.title()
      .enabled(true)
      .useHtml(true)
      .padding([10, 0, 10, 0])
      .text('Suicide Rate (people per 100,000)<br/>');

    map.geoData('anychart.maps.world');
    //map.interactivity().selectionMode('none');
    map.padding(0);


    //var dataSet = getData();
    var dataSet = anychart.data.set(data)
    var suicide_data = dataSet.mapAs({
      'value': 'avgration'
    });
    var series = map.choropleth(dataSet);

    series.labels(false);

    series.hovered()
      .fill('#f48fb1')
      .stroke(anychart.color.darken('#f48fb1'));

    series.selected()
      .fill('#c2185b')
      .stroke(anychart.color.darken('#c2185b'));

    series.tooltip()
      .useHtml(true)
      .format(function() {
        return '<span style="color: #d9d9d9">Density</span>: ' +
          parseFloat(this.value).toLocaleString() + ' pop./km&#178 <br/>' +
          '<span style="color: #d9d9d9">Population</span>: ' +
          parseInt(this.getData('id')).toLocaleString() + ' km&#178';
      });

    var scale = anychart.scales.ordinalColor([{
        less: 5
      },
      {
        from: 5,
        to: 10
      },
      {
        from: 10,
        to: 15
      },
      {
        from: 15,
        to: 20
      },
      {
        from: 100,
        to: 200
      },
      {
        from: 200,
        to: 300
      },
      {
        from: 300,
        to: 500
      },
      {
        from: 500,
        to: 1000
      },
      {
        greater: 1000
      }
    ]);
    scale.colors(['#81d4fa', '#4fc3f7', '#29b6f6', '#039be5', '#0288d1', '#0277bd', '#01579b', '#014377', '#000000']);

    var colorRange = map.colorRange();
    colorRange.enabled(false)
      .padding([0, 0, 20, 0]);
    colorRange.ticks()
      .enabled(true)
      .stroke('3 #ffffff')
      .position('center')
      .length(7);
    colorRange.colorLineSize(5);
    colorRange.marker().size(7);
    colorRange.labels()
      .fontSize(11)
      .padding(3, 0, 0, 0)
      .format(function() {
        var range = this.colorRange;
        var name;
        if (isFinite(range.start + range.end)) {
          name = range.start + ' - ' + range.end;
        } else if (isFinite(range.start)) {
          name = 'More than ' + range.start;
        } else {
          name = 'Less than ' + range.end;
        }
        return name
      });

    series.colorScale(scale);


    // create zoom controls
    var zoomController = anychart.ui.zoom();
    zoomController.render(map);

    map.bounds(100, 0, '100%', '60%');

    // set container id for the chart
    map.container(stage);
    // initiate chart drawing
    map.draw();

    var chart = anychart.line()
    chart.spline(
    // set series data
    [
      ['January', 10000],
      ['February', 12000],
      ['March', 18000],
      ['April', 11000],
      ['May', 9000]
    ]);
    
    // set chart container
    chart.bounds(0, 520, '45%', '30%');
    chart.container(stage);
    chart.draw()

    // anychart.onDocumentReady(function () {
    // var chart = anychart.line([
    //     {x: "Meat", value: 10},
    //     {x: "Fruit", value: 12},
    //     {x: "Nuts", value: 18},
    //     {x: "Milk", value: 11},
    //     {x: "Fish", value: 9}
    // ]);

    // // Set chart bounds.
    // chart.bounds(0, 520, '45%', '30%');

    // chart.title("Set chart bounds");
    // chart.container(stage);
    // chart.draw();
  });

})


    </script>

</body>
</html>

                